import { Router } from "express";
import passport from "passport";
import  initializePassport  from "../auth/passport.js";

import {logout,register,login,restore,github,githubcallback } from "../controllers/sessions.controller.js";

export const sessionsRouter = Router();


////////////////////////////////////////////////////////////////
sessionsRouter.get("/logout", logout);

////////////////////////////////////////////////////////////////////////////
sessionsRouter.post("/register", passport.authenticate("register"),register);


//////////////////////////////////////////////////////////////////////////////////////////////////////
sessionsRouter.post("/login", passport.authenticate("login"),login);


//////////////////////////////////////////////////////////////////////////////////////////////////////
sessionsRouter.put("/restore", restore);

///////////////////////////////////////////////////////////////////////////////////////////////////////
sessionsRouter.get("/github", passport.authenticate("githublogin", { scope: ["user:email"] }),github);

//////////////////////////////////////////////////////////////////////////////////////////////////////
sessionsRouter.get("/githubcallback",passport.authenticate("githublogin", { failureRedirect: "/login" }),githubcallback);


////////////////////////////////////////////////////////////////////////////////////////////
export default sessionsRouter;